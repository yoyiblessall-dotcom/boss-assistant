<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>è€é—†å°å‰¯æ‰‹ - å…§å®¹ç·¨è¼¯å¾Œå°</title>
<style>
  body { font-family: "Microsoft JhengHei", sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; background: #f5f5f5; }
  .container { background: white; padding: 30px; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
  h2 { border-bottom: 2px solid #005bac; padding-bottom: 10px; color: #333; margin-top: 0; }
  
  .qa-item { background: #f9f9f9; padding: 15px; border-radius: 8px; border: 1px solid #ddd; margin-bottom: 15px; display: flex; gap: 15px; align-items: start; }
  .qa-content { flex: 1; }
  .qa-num { font-weight: bold; color: #005bac; padding-top: 5px; min-width: 30px; }
  
  label { display: block; font-size: 12px; color: #666; font-weight: bold; margin-bottom: 4px; margin-top: 8px; }
  input[type="text"] { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; font-weight: bold; color: #333; }
  textarea { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; height: 60px; resize: vertical; }
  
  .btn-del { background: #ff4d4f; color: white; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; margin-top: 30px; }
  .btn-del:hover { background: #d9363e; }
  
  .controls { margin-top: 20px; text-align: right; border-top: 1px solid #eee; padding-top: 20px; }
  .btn-add { background: #28a745; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-size: 16px; margin-right: 10px;}
  .btn-save { background: #005bac; color: white; border: none; padding: 10px 30px; border-radius: 5px; cursor: pointer; font-size: 16px; font-weight: bold; }
  .btn-save:disabled { background: #ccc; }
  
  .loading { text-align: center; color: #888; padding: 20px; }
</style>
</head>
<body>

<div class="container">
  <h2>ğŸ› ï¸ å…§å®¹ç·¨è¼¯å¾Œå°</h2>
  <div id="infoBar" style="margin-bottom:20px; font-size:14px; color:#666;">
    æ­£åœ¨è®€å–æ‚¨çš„è³‡æ–™...
  </div>
  
  <div id="qaList">
    <div class="loading">â³ è¼‰å…¥ä¸­...</div>
  </div>

  <div class="controls">
    <button class="btn-add" onclick="addQA()">+ æ–°å¢æŒ‰éˆ•</button>
    <button class="btn-save" onclick="saveQA()">ğŸ’¾ å„²å­˜ä¿®æ”¹</button>
  </div>
</div>

<script>
  // ğŸ”´ è«‹åœ¨é€™è£¡å¡«å…¥ä½ çš„ GAS ç¶²å€ ğŸ”´
  const API_URL = "https://script.google.com/macros/s/AKfycbz7IJ4YuR2GkR5m61Z8l2TZoqtIy9g7r-YPB1Xx_31gZhkhvZ01N8LTux5jqIzULXdvXw/exec"; 

  const urlParams = new URLSearchParams(window.location.search);
  const CLIENT_ID = urlParams.get('id');

  // ç‚ºäº†è®“å¾Œå°çŸ¥é“é è¨­å•é¡Œæ˜¯ä»€éº¼ï¼Œæˆ‘å€‘å¿…é ˆæŠŠé è¨­è³‡æ–™ä¹Ÿæ”¾é€²ä¾†
  const industries = {
    pc_repair: { name: "é›»è…¦ç¶­ä¿®", faqs: [{q:"é–‹ä¸äº†æ©Ÿ",a:"é–‹ä¸äº†æ©Ÿï¼Ÿå…ˆæª¢æŸ¥æ’é ­é¬†äº†æ²’ï¼å¦‚æœé¢¨æ‰‡æœ‰è½‰è¢å¹•é»‘ï¼Œå¯èƒ½æ˜¯é¡¯å¡å•é¡Œã€‚"},{q:"è·‘è¶…æ…¢",a:"é›»è…¦è·‘å¾ˆæ…¢é€šå¸¸æ˜¯ç¡¬ç¢Ÿè€åŒ–ï¼Œå»ºè­°æ‰¾è€é—†å‡ç´š SSDï¼Œé€Ÿåº¦å¿«5å€ï¼"},{q:"é‡çŒå¤šå°‘éŒ¢",a:"ç³»çµ±é‡çŒåŸºæœ¬è²» 800 å…ƒï¼Œå«é©…å‹•èˆ‡å¸¸ç”¨è»Ÿé«”ï¼Œç´„éœ€ 2 å°æ™‚ã€‚"},{q:"è¢å¹•é»‘å±",a:"è¢å¹•é»‘å±ä½†æœ‰è²éŸ³ï¼Ÿè©¦è©¦çœ‹é‡æ¥è¢å¹•ç·šï¼Œä¸è¡Œå°±æ˜¯è¢å¹•æˆ–é¡¯å¡å£äº†ã€‚"}] },
    restaurant: { name: "é¤é£²ç¾é£Ÿ", faqs: [{q:"æˆ‘è¦è¨‚ä½",a:"æ²’å•é¡Œï¼è«‹å•æ‚¨é è¨ˆã€Œå¹¾æœˆå¹¾è™Ÿã€ä»¥åŠã€Œå¹¾ä½ã€ç”¨é¤ï¼Ÿ"},{q:"æ¨è–¦èœè‰²",a:"ç¬¬ä¸€æ¬¡ä¾†å—ï¼Ÿæ¨è–¦å¿…é»ã€Œæ‹›ç‰Œåšåˆ‡è±¬æ’ã€å’Œã€Œæ¾éœ²ç‡‰é£¯ã€ï¼"},{q:"ç‡Ÿæ¥­æ™‚é–“",a:"æˆ‘å€‘æ¯å¤© 11:00 - 21:00 ç‡Ÿæ¥­ï¼Œæœ€å¾Œé»é¤æ™‚é–“ç‚º 20:30ã€‚"}] },
    beauty: { name: "ç¾å®¹ç¾é«®", faqs: [{q:"é ç´„å‰ªé«®",a:"å¥½çš„ï¼Œè«‹å•æ‚¨æƒ³æŒ‡å®šå“ªä½è¨­è¨ˆå¸«ï¼Ÿ"},{q:"åƒ¹ç›®è¡¨",a:"æ´—+å‰ª 600å…ƒï¼ŒæŸ“é«®çŸ­é«® 1500 èµ·ï¼Œç‡™é«® 2000 èµ·ã€‚"}] },
    real_estate: { name: "æˆ¿ç”¢é¡§å•", faqs: [{q:"æœ€æ–°ç‰©ä»¶",a:"æœ¬é€±æ–°é€²ï¼šå¸‚ä¸­å¿ƒä¸‰æˆ¿è»Šä½ã€æ·é‹æ—å°è±ªå®…ã€‚"},{q:"æˆ‘è¦è³£æˆ¿",a:"æˆ‘å€‘å¯ä»¥å…è²»å¹«æ‚¨ä¼°åƒ¹ï¼Œæ­¡è¿é ç´„ã€‚"}] },
    gym: { name: "å¥èº«æ•™ç·´", faqs: [{q:"æœƒç±è²»ç”¨",a:"ç›®å‰æ¨å»£æ–¹æ¡ˆï¼šå–®æœˆ 1288ï¼Œå¹´ç´„æ¯æœˆ 988ã€‚"},{q:"åœ˜èª²èª²è¡¨",a:"ç‘œçˆã€æ‹³æ“Šæœ‰æ°§èª²è¡¨å·²æ›´æ–°ï¼Œæˆ‘å¯ä»¥å‚³çµ¦æ‚¨ã€‚"}] },
    car: { name: "æ±½è»Šä¿ä¿®", faqs: [{q:"å®šæœŸä¿é¤Š",a:"å»ºè­°æ¯ 5000 å…¬é‡Œæ›æ©Ÿæ²¹ã€‚"},{q:"è¼ªèƒåƒ¹æ ¼",a:"è«‹å•æ‚¨çš„è¼ªèƒè¦æ ¼ï¼Ÿæˆ‘å¹«æ‚¨å ±åƒ¹ã€‚"}] },
    shop: { name: "ç¶²æ‹å®¢æœ", faqs: [{q:"è¨‚å–®æŸ¥è©¢",a:"è«‹çµ¦æˆ‘è¨‚å–®ç·¨è™Ÿï¼Œæˆ‘å¹«æ‚¨æŸ¥ã€‚"},{q:"é‹è²»è¨ˆç®—",a:"æ»¿ 1000 å…é‹ã€‚"}] },
    clinic: { name: "è¨ºæ‰€æ›è™Ÿ", faqs: [{q:"é–€è¨ºæ™‚é–“",a:"æ—©è¨º 09:00-12:00ï¼Œåˆè¨º 14:30-17:30ã€‚"},{q:"é ç´„æ›è™Ÿ",a:"åˆè¨ºéœ€ç¾å ´å¡«è¡¨ï¼Œè¤‡è¨ºå¯é€é LINE é ç´„ã€‚"}] },
    plumbing: { name: "æ°´é›»ç¶­ä¿®", faqs: [{q:"é¦¬æ¡¶ä¸é€š",a:"æˆ‘å€‘å¯ä»¥é€šé¦¬æ¡¶ï¼Œè²»ç”¨ç´„ 1500 å…ƒã€‚"},{q:"å®¶è£¡è·³é›»",a:"å¯èƒ½æ˜¯è² è¼‰éå¤§æˆ–çŸ­è·¯ã€‚"}] },
    tutor: { name: "è£œç¿’ç­", faqs: [{q:"èª²ç¨‹è²»ç”¨",a:"åœ‹ä¸­å…¨ç§‘ç­ä¸€å­¸æœŸ 35000ã€‚"},{q:"è©¦è½å®‰æ’",a:"æ­¡è¿å…è²»è©¦è½ä¸€å ‚ï¼"}] }
  };

  let currentQA = [];

  async function init() {
    if (!CLIENT_ID) return alert("ç¶²å€éŒ¯èª¤ï¼šç¼ºå°‘ ID");
    
    try {
      const res = await fetch(`${API_URL}?action=check_auth&client_id=${CLIENT_ID}`);
      const data = await res.json();
      
      if (data.status === 'error') return alert("ç„¡æ•ˆçš„å®¢æˆ¶ ID");

      document.getElementById("infoBar").innerText = `æ‚¨å¥½ï¼Œé€™è£¡æ˜¯ã€${data.industry}ã€‘æ©Ÿå™¨äººçš„ç·¨è¼¯å¾Œå°`;

      // 1. å¦‚æœæœ‰è‡ªè¨‚éï¼Œç”¨è‡ªè¨‚çš„
      if (data.custom_qa) {
        currentQA = data.custom_qa;
      } 
      // 2. å¦‚æœæ²’è‡ªè¨‚éï¼Œè¼‰å…¥é è¨­è¡Œæ¥­çš„å•é¡Œ (ä¿®æ­£äº†ä¹‹å‰ç©ºç™½çš„å•é¡Œ)
      else if (data.industry && industries[data.industry]) {
        currentQA = industries[data.industry].faqs;
      } 
      // 3. è¬ä¸€éƒ½æ²’æœ‰
      else {
        currentQA = [{q: "ç¯„ä¾‹å•é¡Œ", a: "ç¯„ä¾‹å›ç­”"}];
      }
      
      render();
      
    } catch (e) {
      alert("é€£ç·šéŒ¯èª¤ï¼š" + e);
    }
  }

  function render() {
    const list = document.getElementById('qaList');
    list.innerHTML = "";
    
    currentQA.forEach((item, index) => {
      const div = document.createElement('div');
      div.className = 'qa-item';
      div.innerHTML = `
        <div class="qa-num">#${index+1}</div>
        <div class="qa-content">
          <label>æŒ‰éˆ•æ–‡å­— (å®¢äººé»çš„)ï¼š</label>
          <input type="text" value="${item.q}" onchange="updateItem(${index}, 'q', this.value)">
          <label>æ©Ÿå™¨äººå›ç­”ï¼š</label>
          <textarea onchange="updateItem(${index}, 'a', this.value)">${item.a}</textarea>
        </div>
        <button class="btn-del" onclick="delQA(${index})">åˆªé™¤</button>
      `;
      list.appendChild(div);
    });
  }

  function updateItem(index, key, value) {
    currentQA[index][key] = value;
  }

  function addQA() {
    currentQA.push({ q: "æ–°æŒ‰éˆ•", a: "è«‹è¼¸å…¥å›ç­”" });
    render();
  }

  function delQA(index) {
    if (confirm("ç¢ºå®šåˆªé™¤ï¼Ÿ")) {
      currentQA.splice(index, 1);
      render();
    }
  }

  async function saveQA() {
    const btn = document.querySelector('.btn-save');
    btn.innerText = "å„²å­˜ä¸­...";
    btn.disabled = true;

    try {
      await fetch(API_URL, {
        method: 'POST',
        mode: 'no-cors',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          action: 'save_qa',
          client_id: CLIENT_ID,
          qa_list: currentQA
        })
      });
      
      alert("âœ… å„²å­˜æˆåŠŸï¼æ©Ÿå™¨äººå·²æ›´æ–°ã€‚");
      
    } catch (e) {
      alert("å„²å­˜å¤±æ•—");
    }

    btn.innerText = "ğŸ’¾ å„²å­˜ä¿®æ”¹";
    btn.disabled = false;
  }

  init();
</script>
</body>
</html>