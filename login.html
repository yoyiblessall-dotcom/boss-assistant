<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover, interactive-widget=resizes-content">
<title>STANDALONE OS | User Interface</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
<style>
  :root { --accent: #fff; --glow: rgba(255, 255, 255, 0.5); --bg-deep: #000; --glass: rgba(255, 255, 255, 0.03); --border: rgba(255, 255, 255, 0.08); }
  * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
  body { margin: 0; padding: 0; font-family: 'Space Grotesk', -apple-system, "Microsoft JhengHei", "Heiti TC", sans-serif; background-color: var(--bg-deep); color: #fff; height: 100dvh; width: 100vw; display: flex; flex-direction: column; overflow: hidden; }
  .aether-void { position: absolute; inset: -50%; background: conic-gradient(from 0deg, transparent 0deg, var(--aurora-1) 60deg, transparent 120deg, var(--aurora-2) 180deg, transparent 240deg, var(--aurora-3) 300deg, transparent 360deg); filter: blur(90px); opacity: 0.35; animation: rotateVoid 30s linear infinite; z-index: -1; transition: all 2s ease; }
  .noise-overlay { position: absolute; inset: 0; background: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.7' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.03'/%3E%3C/svg%3E"); pointer-events: none; z-index: -1; }
  @keyframes rotateVoid { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
  .hud-top { flex: 0 0 auto; padding: calc(20px + env(safe-area-inset-top)) 24px 20px 24px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid rgba(255,255,255,0.05); background: linear-gradient(to bottom, rgba(0,0,0,0.8), transparent); backdrop-filter: blur(10px); z-index: 10; }
  .brand-logo { font-size: 16px; letter-spacing: 1px; font-weight: 700; color: rgba(255,255,255,0.95); display: flex; align-items: center; gap: 10px; }
  .status-light { width: 6px; height: 6px; background: #00ff88; border-radius: 50%; box-shadow: 0 0 10px #00ff88; animation: pulse 2s infinite; }
  .nav-actions { display: flex; gap: 8px; }
  .nav-btn { background: var(--glass); border: 1px solid var(--border); color: rgba(255,255,255,0.9); text-decoration: none; font-size: 11px; font-weight: 500; padding: 6px 14px; border-radius: 4px; transition: 0.3s; display: none; align-items: center; gap: 6px; }
  .stream-viewport { flex: 1; overflow-y: auto; padding: 30px 24px; display: flex; flex-direction: column; gap: 24px; mask-image: linear-gradient(to bottom, transparent 0%, black 10%, black 90%, transparent 100%); -webkit-mask-image: linear-gradient(to bottom, transparent 0%, black 10%, black 90%, transparent 100%); scroll-behavior: smooth; }
  .node { display: flex; flex-direction: column; max-width: 88%; animation: driftUp 0.5s cubic-bezier(0.2, 0.8, 0.2, 1); }
  .node.bot { align-self: flex-start; border-left: 2px solid var(--accent); padding-left: 18px; }
  .node.user { align-self: flex-end; align-items: flex-end; border-right: 2px solid rgba(255,255,255,0.3); padding-right: 18px; }
  .node-text { font-size: 15px; line-height: 1.7; font-weight: 400; text-shadow: 0 1px 2px rgba(0,0,0,0.8); }
  .node.bot .node-text { color: rgba(255,255,255,0.95); }
  .node.user .node-text { color: var(--accent); text-align: right; }
  .monolith-dock { flex: 0 0 auto; padding: 0 0 calc(20px + env(safe-area-inset-bottom)) 0; background: linear-gradient(to top, #000 40%, transparent); display: flex; flex-direction: column; gap: 15px; z-index: 20; }
  .orbit-wrapper { position: relative; width: 100%; display: flex; align-items: center; }
  .orbit-wrapper::after { content: ''; position: absolute; right: 0; top: 0; bottom: 0; width: 50px; background: linear-gradient(to right, transparent, #000); pointer-events: none; z-index: 2; }
  .orbit-bar { display: flex; gap: 10px; overflow-x: auto; padding: 5px 24px; scrollbar-width: none; flex: 1; scroll-behavior: smooth; }
  .orbit-bar::-webkit-scrollbar { display: none; }
  .orbit-chip { flex: 0 0 auto; padding: 10px 20px; background: rgba(0,0,0,0.6); border: 1px solid var(--border); color: rgba(255,255,255,0.9); font-size: 13px; letter-spacing: 1px; cursor: pointer; transition: 0.3s; backdrop-filter: blur(10px); white-space: nowrap; font-family: inherit; }
  .orbit-chip:hover { border-color: var(--accent); color: var(--accent); background: rgba(255,255,255,0.1); }
  .scroll-btn-right { position: absolute; right: 10px; z-index: 10; width: 32px; height: 32px; border-radius: 50%; background: rgba(255,255,255,0.15); border: 1px solid var(--border); color: var(--accent); display: flex; align-items: center; justify-content: center; backdrop-filter: blur(5px); cursor: pointer; box-shadow: 0 0 15px rgba(0,0,0,0.8); animation: bounceRight 2s infinite; }
  @keyframes bounceRight { 0%, 100% { transform: translateX(0); } 50% { transform: translateX(3px); } }
  .core-input-wrapper { margin: 0 24px; height: 50px; border-bottom: 1px solid rgba(255,255,255,0.2); display: flex; align-items: center; gap: 15px; transition: 0.3s; }
  .core-input { flex: 1; background: transparent; border: none; color: white; font-size: 16px; outline: none; }
  .transmit-btn { background: transparent; border: none; color: rgba(255,255,255,0.5); font-size: 13px; cursor: pointer; }
  @keyframes pulse { 0%, 100% { opacity: 0.5; } 50% { opacity: 1; } }
  @keyframes driftUp { from { opacity: 0; transform: translateY(20px); filter: blur(5px); } to { opacity: 1; transform: translateY(0); filter: blur(0); } }
  .boot-screen { position: fixed; inset: 0; background: #000; z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; font-family: 'Space Grotesk', monospace; }
  .glitch-text { font-size: 26px; letter-spacing: 3px; color: #fff; animation: glitch 1s infinite; }
  @keyframes glitch { 0% { opacity: 1; } 50% { opacity: 0.8; text-shadow: 2px 0 red, -2px 0 blue; } 100% { opacity: 1; } }
  #demoControls { position: fixed; top: 100px; left: 24px; z-index: 50; opacity: 0; pointer-events: none; transition: 0.3s; }
  #demoControls.show { opacity: 1; pointer-events: auto; }
  .matrix-select { background: rgba(0,0,0,0.8); border: 1px solid #444; color: #eee; padding: 8px 12px; font-family: inherit; font-size: 13px; backdrop-filter: blur(5px); }
  #loginOverlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000000; z-index: 2147483647 !important; display: none; justify-content: center; align-items: center; flex-direction: column; }
  .login-box { width: 90%; max-width: 400px; background: rgba(20, 20, 20, 0.8); border: 1px solid #333; border-radius: 20px; padding: 40px; text-align: center; backdrop-filter: blur(10px); box-shadow: 0 0 50px rgba(0, 255, 136, 0.1); }
  .login-title { color: #fff; font-size: 20px; margin-bottom: 20px; letter-spacing: 2px; }
  .login-input { width: 100%; padding: 15px; background: #000; border: 1px solid #444; color: #00ff88; font-family: monospace; text-align: center; font-size: 16px; border-radius: 10px; margin-bottom: 20px; outline: none; }
  .login-input:focus { border-color: #00ff88; box-shadow: 0 0 15px rgba(0,255,136,0.2); }
  .login-btn { padding: 12px 30px; background: #00ff88; color: #000; border: none; border-radius: 50px; font-weight: bold; cursor: pointer; transition: 0.3s; }
  .login-btn:hover { transform: scale(1.05); box-shadow: 0 0 20px #00ff88; }
</style>
</head>
<body>

<div id="loginOverlay">
    <div class="login-box">
        <div class="login-title">SYSTEM LOGIN</div>
        <p style="color:#888; font-size:12px; margin-bottom:20px;">請輸入您的系統 ID (Access Token)</p>
        <input type="text" id="unique_gate_input" class="login-input" placeholder="Paste ID Here...">
        <button class="login-btn" onclick="executeFinalLogin()">ENTER SYSTEM</button>
        <p style="margin-top:20px; font-size:10px; color:#555;">* 此 ID 為您付費後取得的專屬網址參數</p>
    </div>
</div>

<script>
    (function() {
        const urlParams = new URLSearchParams(window.location.search);
        const currentId = urlParams.get('id');
        const overlay = document.getElementById('loginOverlay');
        if (currentId) {
            if (overlay) overlay.remove();
        } else {
            if (overlay) {
                overlay.style.display = 'flex';
                const myInput = document.getElementById('unique_gate_input');
                if (myInput) {
                    myInput.addEventListener("keypress", function(event) {
                        if (event.key === "Enter") {
                            event.preventDefault();
                            executeFinalLogin(); 
                        }
                    });
                    setTimeout(() => myInput.focus(), 100); 
                }
            }
            const style = document.createElement('style');
            style.innerHTML = `body > *:not(#loginOverlay):not(script) { display: none !important; }`;
            document.head.appendChild(style);
        }
    })();
    function executeFinalLogin() {
        const inputEl = document.getElementById('unique_gate_input');
        if (!inputEl) return;
        const finalVal = inputEl.value.trim();
        if (finalVal && finalVal.length > 5) {
            window.location.href = window.location.pathname + '?id=' + finalVal;
        } else {
            alert("錯誤：ID 無效！");
        }
    }
</script>

<div class="aether-void" id="aetherBg"></div>
<div class="noise-overlay"></div>
<div class="boot-screen" id="bootLayer">
  <div class="glitch-text">STANDALONE_OS</div>
  <div style="margin-top:20px; font-size:12px; color:#666; letter-spacing:1px;">系統核心啟動中...</div>
</div>
<div class="hud-top">
  <div class="brand-logo">
    <div class="status-light" id="statusLight"></div>
    <span id="brandTitle">系統待機</span>
  </div>
  <div class="nav-actions">
    <a href="#" class="nav-btn" id="btnPhone"><i class="fas fa-phone"></i> 通話</a>
    <a href="#" class="nav-btn" id="btnLine"><i class="fab fa-line"></i> LINE</a>
  </div>
</div>
<div id="demoControls">
  <select class="matrix-select" onchange="manualSwitch(this.value)">
    <option value="pc_repair">01 / 電腦維修 / 科技青</option>
    <option value="restaurant">02 / 餐飲美食 / 琥珀橘</option>
    <option value="beauty">03 / 時尚美學 / 霓虹紫</option>
    <option value="real_estate">04 / 房產顧問 / 奢華金</option>
    <option value="gym">05 / 健身教練 / 毒液綠</option>
    <option value="car">06 / 汽車保修 / 鋼鐵藍</option>
    <option value="shop">07 / 網拍客服 / 珊瑚紅</option>
    <option value="clinic">08 / 診所掛號 / 醫療青</option>
    <option value="plumbing">09 / 水電維修 / 深海藍</option>
    <option value="tutor">10 / 補習班 / 智慧靛</option>
  </select>
</div>
<div class="stream-viewport" id="chatBody"></div>
<div class="monolith-dock">
  <div class="orbit-wrapper">
    <div class="orbit-bar" id="quickActions"></div>
    <button class="scroll-btn-right" id="scrollArrow" onclick="scrollMenu()" style="display:none;"><i class="fas fa-chevron-right"></i></button>
  </div>
  <div class="core-input-wrapper">
    <input type="text" class="core-input" id="userInput" placeholder="輸入訊息..." autocomplete="off">
    <button class="transmit-btn" onclick="handleSend()">發送</button>
  </div>
</div>

<script>
const _raw = [104,116,116,112,115,58,47,47,115,99,114,105,112,116,46,103,111,111,103,108,101,46,99,111,109,47,109,97,99,114,111,115,47,115,47,65,75,102,121,99,98,122,55,73,74,52,89,117,82,50,71,107,82,53,109,54,49,90,56,108,50,84,90,111,113,116,73,121,57,103,55,114,45,89,80,66,49,88,120,95,51,49,103,90,104,107,104,118,90,48,49,78,56,76,84,117,120,53,106,113,73,122,85,76,88,100,118,88,119,47,101,120,101,99];
const API_URL = String.fromCharCode(..._raw);

const urlParams = new URLSearchParams(window.location.search);
const CLIENT_ID = urlParams.get('id');

const themes = {
  pc_repair: { name: "電腦維修 // TECH", vars: { "--aurora-1": "#00f260", "--aurora-2": "#0575e6", "--aurora-3": "#00f260", "--accent": "#00f260", "--glow": "rgba(0, 242, 96, 0.4)" }, welcome: "系統檢測中... 請問您的電腦遇到什麼狀況？", faqs: [{q:"無法開機",a:"請檢查電源插頭與指示燈是否亮起。"}, {q:"電腦變慢",a:"建議清理磁碟或升級 SSD 硬碟。"}, {q:"疑似中毒",a:"請立即斷開網路並重新啟動。"}, {q:"資料救援",a:"請勿再寫入任何資料，立即送修。"}, {q:"到府維修",a:"請提供您的地址，我們將安排工程師。"}] },
  restaurant: { name: "精緻餐飲 // FOOD", vars: { "--aurora-1": "#ff416c", "--aurora-2": "#ff4b1f", "--aurora-3": "#ff9068", "--accent": "#ff9068", "--glow": "rgba(255, 144, 104, 0.4)" }, welcome: "歡迎光臨，為您安排美好的一餐。", faqs: [{q:"我要訂位",a:"請告知用餐人數與時間。"}, {q:"主廚推薦",a:"今日推薦：黑松露野菇燉飯。"}] },
  beauty: { name: "時尚美學 // VOGUE", vars: { "--aurora-1": "#833ab4", "--aurora-2": "#fd1d1d", "--aurora-3": "#fcb045", "--accent": "#da77f2", "--glow": "rgba(218, 119, 242, 0.4)" }, welcome: "您好，想換個新造型嗎？", faqs: [{q:"預約剪髮",a:"請問想預約哪位設計師？"}, {q:"價目表",a:"洗剪服務 800 元起。"}] },
  real_estate: { name: "房產顧問 // ESTATE", vars: { "--aurora-1": "#CAC531", "--aurora-2": "#F3F9A7", "--aurora-3": "#8E8D8A", "--accent": "#F3F9A7", "--glow": "rgba(243, 249, 167, 0.4)" }, welcome: "正在為您搜尋理想物件。", faqs: [{q:"最新物件",a:"目前市中心有幾間不錯的物件..."}, {q:"預約看房",a:"請留下您的聯絡電話。"}] },
  gym: { name: "健身教練 // GYM", vars: { "--aurora-1": "#11998e", "--aurora-2": "#38ef7d", "--aurora-3": "#000000", "--accent": "#38ef7d", "--glow": "rgba(56, 239, 125, 0.4)" }, welcome: "準備好流汗了嗎？", faqs: [{q:"會籍費用",a:"月費 988 元起，免入會費。"}, {q:"私人教練",a:"目前有體驗課程優惠中。"}] },
  car: { name: "汽車保修 // AUTO", vars: { "--aurora-1": "#2C3E50", "--aurora-2": "#4CA1AF", "--aurora-3": "#C4E0E5", "--accent": "#4CA1AF", "--glow": "rgba(76, 161, 175, 0.4)" }, welcome: "車子有異音？該保養了？", faqs: [{q:"定期保養",a:"建議每 5000 公里回廠保養。"}, {q:"道路救援",a:"緊急情況請撥打客服電話。"}] },
  shop: { name: "網拍客服 // SHOP", vars: { "--aurora-1": "#FF512F", "--aurora-2": "#DD2476", "--aurora-3": "#FF512F", "--accent": "#FF512F", "--glow": "rgba(255, 81, 47, 0.4)" }, welcome: "您好！關於訂單或退換貨問題？", faqs: [{q:"訂單查詢",a:"請提供您的訂單編號。"}, {q:"退換貨",a:"七天鑑賞期內可申請退換。"}] },
  clinic: { name: "診所掛號 // MED", vars: { "--aurora-1": "#00d2ff", "--aurora-2": "#3a7bd5", "--aurora-3": "#00d2ff", "--accent": "#00d2ff", "--glow": "rgba(0, 210, 255, 0.4)" }, welcome: "早安，需要掛號或健康諮詢嗎？", faqs: [{q:"門診時間",a:"早診 9:00 - 12:00，午診 14:00 - 17:00。"}, {q:"掛號",a:"請提供身分證字號。"}] },
  plumbing: { name: "水電維修 // FIX", vars: { "--aurora-1": "#1A2980", "--aurora-2": "#26D0CE", "--aurora-3": "#1A2980", "--accent": "#26D0CE", "--glow": "rgba(38, 208, 206, 0.4)" }, welcome: "哪裡漏水了？我們馬上過去處理。", faqs: [{q:"馬桶不通",a:"我們有專業設備可協助疏通。"}, {q:"更換水龍頭",a:"有多種款式可供選擇。"}] },
  tutor: { name: "補習班 // STUDY", vars: { "--aurora-1": "#4776E6", "--aurora-2": "#8E54E9", "--aurora-3": "#4776E6", "--accent": "#8E54E9", "--glow": "rgba(142, 84, 233, 0.4)" }, welcome: "想了解什麼課程？", faqs: [{q:"課程試聽",a:"歡迎預約免費試聽課程。"}, {q:"收費方式",a:"詳細費用請洽櫃台諮詢。"}] }
};
let currentKey = "pc_repair"; let currentData = themes.pc_repair;
async function init() {
  if (!CLIENT_ID) {
    setTimeout(() => { document.getElementById("bootLayer").style.opacity = 0; setTimeout(()=> document.getElementById("bootLayer").style.display = "none", 1000); document.getElementById("demoControls").classList.add("show"); manualSwitch('pc_repair'); }, 2000);
    return;
  }
  try {
    const res = await fetch(`${API_URL}?action=check_auth&client_id=${CLIENT_ID}`);
    const data = await res.json();
    if (data.status === 'error' || data.status === 'expired') { document.querySelector('.glitch-text').innerText = "ACCESS_DENIED"; document.querySelector('.glitch-text').style.color = "#ff3b30"; return; }
    if(data.phone) { const btn = document.getElementById("btnPhone"); btn.href = `tel:${data.phone}`; btn.style.display = "flex"; }
    if(data.line) { const btn = document.getElementById("btnLine"); btn.href = data.line; btn.style.display = "flex"; }
    let industryKey = "pc_repair"; if (data.industry && themes[data.industry]) industryKey = data.industry;
    let visualKey = industryKey; if (data.theme_preference && themes[data.theme_preference]) visualKey = data.theme_preference;
    const baseContent = themes[industryKey];
    currentData = { name: data.shop_name || baseContent.name, welcome: baseContent.welcome, faqs: data.custom_qa || baseContent.faqs };
    applySeparatedTheme(visualKey, currentData);
    setTimeout(() => { document.getElementById("bootLayer").style.opacity = 0; setTimeout(()=> document.getElementById("bootLayer").style.display = "none", 1000); }, 1500);
  } catch (e) { console.error(e); document.querySelector('.glitch-text').innerText = "CONNECTION_FAIL"; }
}
function manualSwitch(key) { currentKey = key; currentData = themes[key]; applySeparatedTheme(key, currentData); }
function applySeparatedTheme(visualKey, contentData) {
  const root = document.documentElement; const visualVars = themes[visualKey].vars;
  for (const [k, v] of Object.entries(visualVars)) { root.style.setProperty(k, v); }
  document.getElementById("brandTitle").innerText = contentData.name; document.title = contentData.name;
  document.getElementById("statusLight").style.backgroundColor = visualVars["--accent"]; document.getElementById("statusLight").style.boxShadow = `0 0 10px ${visualVars["--accent"]}`;
  const chatBody = document.getElementById("chatBody"); chatBody.innerHTML = "";
  setTimeout(() => { addNode("bot", contentData.welcome); }, 500); updateOrbit(contentData.faqs);
}
function updateOrbit(faqs) {
  const bar = document.getElementById("quickActions"); const arrow = document.getElementById("scrollArrow"); bar.innerHTML = "";
  if(faqs && faqs.length > 0) { faqs.forEach(item => { const chip = document.createElement("button"); chip.className = "orbit-chip"; chip.innerText = item.q; chip.onclick = () => handleInput(item.q, item.a); bar.appendChild(chip); }); setTimeout(() => { if(bar.scrollWidth > bar.clientWidth) { arrow.style.display = "flex"; } else { arrow.style.display = "none"; } }, 100); } else { arrow.style.display = "none"; }
}
function scrollMenu() { const bar = document.getElementById("quickActions"); bar.scrollBy({ left: 150, behavior: 'smooth' }); }
document.getElementById("quickActions").addEventListener("scroll", function() { const bar = this; const arrow = document.getElementById("scrollArrow"); if(bar.scrollLeft + bar.clientWidth >= bar.scrollWidth - 10) { arrow.style.opacity = "0.3"; } else { arrow.style.opacity = "1"; } });
function handleInput(q, a) {
  addNode("user", q); showProcessing();
  setTimeout(() => { removeProcessing(); addNode("bot", a); if (CLIENT_ID) { fetch(API_URL, { method: 'POST', mode: 'no-cors', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({ action: 'log_chat', client_id: CLIENT_ID, type: 'button', message: q, bot_response: a }) }); } }, 800);
}
function handleSend() {
  const input = document.getElementById("userInput"); const text = input.value.trim(); if(!text) return;
  addNode("user", text); input.value = ""; showProcessing();
  let ans = "如需詳細服務，請點擊上方按鈕聯絡專人。"; if (currentData.faqs) { for(let f of currentData.faqs) { if(text.includes(f.q)) ans = f.a; } }
  setTimeout(() => { removeProcessing(); addNode("bot", ans); if (CLIENT_ID) { fetch(API_URL, { method: 'POST', mode: 'no-cors', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({ action: 'log_chat', client_id: CLIENT_ID, type: 'text', message: text, bot_response: ans }) }); } }, 1000);
}
function addNode(role, text) {
  const body = document.getElementById("chatBody"); const node = document.createElement("div"); node.className = `node ${role}`; node.innerHTML = `<div class="node-text">${text}</div>`; body.appendChild(node); body.scrollTop = body.scrollHeight;
  if (role === 'bot' && CLIENT_ID) { fetch(API_URL, { method: 'POST', mode: 'no-cors', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({ action: 'log_chat', client_id: CLIENT_ID, type: 'bot', message: text }) }); }
}
function showProcessing() { const body = document.getElementById("chatBody"); const node = document.createElement("div"); node.id = "procNode"; node.className = "node bot"; node.innerHTML = `<div class="node-text" style="opacity:0.6; font-size:12px; letter-spacing:1px;">運算中...</div>`; body.appendChild(node); body.scrollTop = body.scrollHeight; }
function removeProcessing() { const el = document.getElementById("procNode"); if(el) el.remove(); }
document.getElementById("userInput").addEventListener("keypress", (e) => { if(e.key==="Enter") handleSend(); });
init();
</script>
</body>
</html>